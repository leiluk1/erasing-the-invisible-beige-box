## Top-4 solution of watermark removal 

### Overview
This project provides our two top performing strategies as Beige-box attacks for effectively removing watermarks. Our approach combines *Watermark Overwriting Attack* and *Rinse Attack* to achieve quite high performance while maintaining image quality.

### Watermark Overwriting Attack

For images protected by the StegaStamp algorithm, we implemented a watermark overwriting attack. This involved inverting the bits of the extracted binary message (i.e., converting 0s to 1s and 1s to 0s) and then encoding this inverted message back into the images. The extraction and encoding processes utilized the original StegaStamp detector and encoder, as detailed in the paper [StegaStamp](https://arxiv.org/abs/1904.05343).

![StegaStamp watermark overwriting attack](./assets/method_1.png)

In our submission, we modified the first 150 images (`0.png` to `149.png`) by overwriting the watermark, while the remaining 150 images were left unaltered. This method successfully removed the watermark from the modified images, achieving an overall watermark detection performance of 0.5. Furthermore, the attack preserved a high level of image quality, with an image quality degradation of approximately 0.065.

The code for this attack can be checked in `notebooks/stegastamp_attack.ipynb`.

### Rinse (2xRegen)

For images with watermarks generated by a variant of the Tree-Ring algorithm (`150.png` to `299.png`), we employed the Rinse (2xRegen) technique, as described in the paper [WAVES](https://arxiv.org/pdf/2401.08573). This technique utilized the FLUX-dev diffusion model (available at Hugging Face) with the following parameters:

- Prompt: "original image"

- Guidance Scale: 10

- Strength: 0.6

- Number of Steps: 10

While this attack demonstrated high effectiveness, it was able to remove only 80% of the watermarks produced by the Tree-Ring algorithm.

The code is available in `notebooks/treering_attack.ipynb`.
